<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>公众投诉2</title>
    <link href="/plug-in/bootstrap3.3.5/css/bootstrap.css" rel="stylesheet">

    <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
    <script src="/plug-in/jquery/jquery-1.8.3.min.js"></script>
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <script src="/plug-in/bootstrap/js/bootstrap.min.js"></script>
    <style>
        * {
            padding: 0;
            margin: 0;
        }

        .an {
            text-decoration: none;
            font-size: 14px;
        }

        #divZZ {
            filter: alpha(opacity=50); /*IE滤镜，透明度50%*/
            -moz-opacity: 0.5; /*Firefox私有，透明度50%*/
            opacity: 0.5; /*其他，透明度50%*/
        }
    </style>
    <script>
        $(function () {
            getEventTypes();
        });

        function btnPhoto() {
            //alert("上传图片");
            $("#chooseImage")[0].click();
        }

        function btnTijiao() {
            var a = $("#Text1").val();
            var b = $("#Text2").val();
            var c = $("#Select1").val();
            var d = $("#Text3").val();
            var e = $("#TextArea1").val();
            var f = $("#Text4").val();

            alert(a + "\n\r" + b + "\n\r" + c + "\n\r" + d + "\n\r" + e + "\n\r" + f);
        }
    </script>
</head>
<body>
<form id="gztsForm" name="gztsForm" action="" method="post" enctype="multipart/form-data">
    <div style="height: 220px; background: #eeeeee url('/images/gzts/bg.png') center center no-repeat;"></div>
    <div style="height: 490px; background: url('/images/gzts/kuang.png') center bottom no-repeat;">
        <div style="height: 490px; width: 800px; margin: 0 auto; overflow: hidden;">
            <div style="font-family: 'Microsoft YaHei'; font-size: 20px; font-weight: bold; height: 30px; line-height: 30px; padding-left: 150px; padding-top: 18px; letter-spacing: 0.1em;">
                我要投诉
            </div>
            <div style="height: 400px; width: 640px; margin: 30px auto 0;">
                <div style="height: 30px; line-height: 30px;">
                    <div style="float: left; height: 30px; line-height: 30px; width: 90px; text-align: right; font-family: 'Microsoft YaHei'; font-size: 14px; color: #717171;">
                        输入姓名：
                    </div>
                    <div style="float: left; height: 30px; line-height: 30px; width: 220px;">
                        <input id="name" name="name" type="text" style="height: 20px; width: 190px; padding: 2px;"/>
                    </div>
                    <div style="float: left; height: 30px; line-height: 30px; width: 90px; text-align: right; font-family: 'Microsoft YaHei'; font-size: 14px; color: #717171;">
                        手机号码：
                    </div>
                    <div style="float: left; height: 30px; line-height: 30px; width: 220px;">
                        <input id="phone" name="phone" type="text" style="height: 20px; width: 190px; padding: 2px;"/>
                    </div>
                    <div style="clear: both;"></div>
                </div>

                <div style="height: 30px; line-height: 30px; margin-top: 15px;">
                    <div style="float: left; height: 30px; line-height: 30px; width: 90px; text-align: right; font-family: 'Microsoft YaHei'; font-size: 14px; color: #717171;">
                        事件类型：
                    </div>
                    <div style="float: left; height: 30px; line-height: 30px; width: 220px;">
                        <select id="eventType" name="eventType" style="height: 30px; width: 198px; color: RGBA(102,102,102,0.7); line-height: 30px;">
                            <option>类型一</option>
                            <option>类型二</option>
                            <option>类型三</option>
                            <option>类型四</option>
                        </select>
                    </div>
                    <div style="float: left; height: 30px; line-height: 30px; width: 90px; text-align: right; font-family: 'Microsoft YaHei'; font-size: 14px; color: #717171;">
                        位置：
                    </div>
                    <div style="float: left; height: 30px; line-height: 30px; width: 220px;">
                        <input id="site" name="site" type="text" onclick="openModel()" style="height: 20px; width: 190px; padding: 2px;"/>
                    </div>
                    <div style="clear: both;"></div>
                </div>

                <div style="height: 205px; line-height: 30px; margin-top: 15px;">
                    <div style="float: left; height: 30px; line-height: 30px; width: 90px; text-align: right; font-family: 'Microsoft YaHei'; font-size: 14px; color: #717171;">
                        详情描述：
                    </div>
                    <div style="float: left; height: 200px; width: 530px;">
                        <textarea id="details" name="details" style="height: 200px; width: 502px; padding: 2px;"></textarea>
                    </div>
                    <div style="clear: both;"></div>
                </div>

                <div style="height: 30px; line-height: 30px; margin-top: 15px;">
                    <div style="float: left; height: 30px; line-height: 30px; width: 90px; text-align: right; font-family: 'Microsoft YaHei'; font-size: 14px; color: #717171;">
                        验证码：
                    </div>
                    <div style="float: left; height: 30px; line-height: 30px; width: 100px;">
                        <input type="text" id="randCode" placeholder="请输入验证码" style="height: 20px; width: 90px; padding: 2px;" name="randCode"/>
                    </div>
                    <div style="float: left; height: 30px; line-height: 30px; width: 120px;">
                        <span width="90" height="30" style="background-color: #eeeeee; margin: 2px;">
                            <img id="randCodeImage" src="/randCodeImage" />
                        </span>
                    </div>
                    <div style="clear: both;"></div>
                </div>

                <div style="height: 30px; line-height: 30px; margin-top: 15px;">
                    <div style="float: left; height: 30px; line-height: 30px; width: 90px; text-align: right; font-family: 'Microsoft YaHei'; font-size: 24px; color: #717171;"></div>
                    <div style="float: left; height: 30px; line-height: 30px; width: 90px;">
                        <a id="btnPhoto" href="javascript:void(0);" onclick="btnPhoto()">
                            <img src="/images/gzts/photo.png" style="height: 30px;"/></a>
                    </div>
                    <div style="float: left; height: 30px; line-height: 30px; width: 360px;">
                        <span id="spanImg" style="font-size: 14px;">上传图片信息</span>
                    </div>
                    <div style="clear: both;"></div>
                </div>
            </div>
        </div>
    </div>
    <div style="margin-top: 10px; text-align: center;">
        <input type="image" id="sub" name="sub" src="/images/gzts/tijiao.png" onclick="submit()" />
    </div>
    <div id="upImg" style="display: none;">
        <input type="file" name="file" id="chooseImage"/>
    </div>
    <div id="divZZ" style="display: none; background-color: black; z-index: 888;"></div>
    <div id="imgPreview" style="height: auto; display: none; background-color: transparent;">
        <div style="height: auto; width: auto; max-width: 600px; border: 1px solid black; padding: 2px; margin: 0 auto; text-align: center; background-color: white">
            <div id="div1" style="height: 30px; line-height: 30px; width: 580px; text-align: right; margin: 0 auto;"><a
                    href="javascript:void(0);" onclick="closePic()" class="an" style="color: red;">关闭</a></div>
            <img src="#" id="cropedBigImg"
                 style="background-color: #dddddd; width: auto; height: auto; max-width: 600px; max-height: 450px;"/>
        </div>
    </div>
</form>
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Modal title</h4>
            </div>
            <div class="modal-body">
                ...
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>
<script>
    $('#chooseImage').on('change', function () {//当chooseImage的值改变时，执行此函数
        $("#spanImg").html("请选择文件！");
        var filePath = $(this).val(); //获取到input的value，里面是文件的路径
        if (filePath != "") {
            var fileFormat = filePath.substring(filePath.lastIndexOf(".")).toLowerCase();
            if (this.files.length > 0) {
                var src = window.URL.createObjectURL(this.files[0]); //转成可以在本地预览的格式

                // 检查是否是图片
                if (!fileFormat.match(/.png|.jpg|.jpeg/)) {
                    alert('上传错误,文件格式必须为：png/jpg/jpeg');
                    $('#cropedBigImg').attr('src', "");
                    $("#spanImg").html("上传错误,文件格式必须为：png/jpg/jpeg");
                } else {
                    $('#cropedBigImg').attr('src', src);
                    $("#spanImg").html("<a href=\"javascript:void(0)\" onclick=\"showPic()\" class=\"an\" style=\"color:red;\">上传图片预览</a>");
                }
            } else {
                alert('上传错误,无图片！');
                $('#cropedBigImg').attr('src', "");
                $("#spanImg").html("上传错误,无图片！");
            }
        } else {
            alert('上传错误,请选择文件！');
            $('#cropedBigImg').attr('src', "");
            $("#spanImg").html("上传错误,请选择文件！");
        }
    });

    function showPic() {
        var h = $(document).height();
        $("#divZZ").css({
            "position": "absolute",
            "left": "0",
            "top": "0",
            "height": h + "px",
            "right": "0",
            "z-index": "999"
        });
        $("#divZZ").show();
        //position: absolute; left: 0; top: 0; right: 0;
        var top = document.documentElement.scrollTop + 100;
        $("#imgPreview").css({"position": "absolute", "left": "0", "top": top + "px", "right": "0", "z-index": "1000"});
        $("#imgPreview").show();
    }

    function closePic() {
        $("#imgPreview").hide();
        $("#divZZ").hide();
    }

    /**
     * 动态获取事件类型
     */
    function getEventTypes() {
        $('#eventType').empty();
        $.post('/sys/dict/getListEventType.do', {}, function (res) {
            $.each(res, function (index, obj) {
                $('#eventType').append('<option value="'+ obj.typecode +'">' + obj.typename + '</option>')
            });
        }, 'json')
    }

    /**
     * 刷新验证码
     */
    $('#randCodeImage').click(function(){
        var date = new Date();
        var img = document.getElementById("randCodeImage");
        img.src='/randCodeImage?a=' + date.getTime();
    });
    
    function openModel() {
        $('#myModal').modal('show');
    }
    
    function map() {
        
    }
</script>

</body>
</html>
